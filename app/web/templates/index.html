<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CodeStreaker</title>
    <link rel="icon" type="image/png" href="/static/favicon.png">
    <link rel="apple-touch-icon" href="/static/favicon.png">

    <link rel="stylesheet" href="/static/styles.css" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
  </head>
  <body>
    <div class="bg-shape"></div>
    <div class="container">
      <div id="error-banner" style="display: none; padding: 12px 14px; margin-bottom: 16px; border-radius: 12px; background: #3a1f1f; color: #ffd7d7; border: 1px solid #5a2b2b;">
        Error loading status.
      </div>
      <header class="topbar">
        <div class="topbar-left">
          <div class="app-icon">CS</div>
          <div class="topbar-title">
            <div class="title">CodeStreaker</div>
            <div class="subtitle">Daily commit + solve streaks</div>
          </div>
        </div>
        <div class="topbar-actions">
          <button class="pill-btn ios-tap ios-button" id="btnAvatar" type="button">
            <span class="avatar-badge" id="avatar-badge">üê∂</span>
            <span>Avatar</span>
          </button>
          <button class="pill-btn ios-tap ios-button" id="btnRefresh" type="button">
            <span class="pill-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none">
                <path
                  d="M20 12a8 8 0 1 1-2.34-5.66"
                  stroke="currentColor"
                  stroke-width="1.8"
                  stroke-linecap="round"
                />
                <path
                  d="M20 4v6h-6"
                  stroke="currentColor"
                  stroke-width="1.8"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </span>
            <span>Refresh</span>
          </button>
        </div>
      </header>

      <section class="card status ios-tap ios-card">
        <div class="card-header">
          <h2>Today</h2>
          <span id="date">‚Äî</span>
        </div>
        <div class="metrics">
          <div class="metric">
            <div class="metric-top">
              <div class="metric-ring ring-github" data-ring="github">
                <svg class="ring-svg" viewBox="0 0 52 52" aria-hidden="true">
                  <circle class="ring-track" cx="26" cy="26" r="22"></circle>
                  <circle class="ring-progress" cx="26" cy="26" r="22"></circle>
                </svg>
                <div class="ring-label" id="github-ring-label">0/0</div>
              </div>
              <div class="metric-main">
                <div class="metric-title">GitHub commits</div>
                <div class="metric-value" id="github">0</div>
                <div class="metric-goal" id="github-goal">/0</div>
              </div>
            </div>
          </div>
          <div class="metric">
            <div class="metric-top">
              <div class="metric-ring ring-leetcode" data-ring="leetcode">
                <svg class="ring-svg" viewBox="0 0 52 52" aria-hidden="true">
                  <circle class="ring-track" cx="26" cy="26" r="22"></circle>
                  <circle class="ring-progress" cx="26" cy="26" r="22"></circle>
                </svg>
                <div class="ring-label" id="leetcode-ring-label">0/0</div>
              </div>
              <div class="metric-main">
                <div class="metric-title">LeetCode solved</div>
                <div class="metric-value" id="leetcode">0</div>
                <div class="metric-goal" id="leetcode-goal">/0</div>
              </div>
            </div>
          </div>
        </div>
        <div class="streaks">
          <div class="streak-card">
            <div>Current streak</div>
            <div class="streak-num" id="current-streak">0</div>
          </div>
          <div class="streak-card">
            <div>Best streak</div>
            <div class="streak-num" id="best-streak">0</div>
          </div>
        </div>

        <div class="weekly">
          <div class="weekly-header">
            <h3>This week</h3>
            <span class="weekly-tz" id="weekly-tz">Europe/Kyiv</span>
          </div>
          <div class="heatmap-legend">
            <span>Less</span>
            <div class="legend-squares">
              <span class="legend-square hm-0"></span>
              <span class="legend-square hm-1"></span>
              <span class="legend-square hm-2"></span>
              <span class="legend-square hm-3"></span>
              <span class="legend-square hm-4"></span>
            </div>
            <span>More</span>
          </div>
          <div class="heatmap">
            <div class="heatmap-days">
              <span>Mon</span>
              <span>Tue</span>
              <span>Wed</span>
              <span>Thu</span>
              <span>Fri</span>
              <span>Sat</span>
              <span>Sun</span>
            </div>
            <div class="heatmap-row">
              <div class="heatmap-label">GitHub</div>
              <div class="heatmap-grid" data-heatmap="github"></div>
            </div>
            <div class="heatmap-row">
              <div class="heatmap-label">LeetCode</div>
              <div class="heatmap-grid" data-heatmap="leetcode"></div>
            </div>
            <div class="streak-rail">
              <div class="streak-rail-header">
                <span>Week score</span>
                <span id="week-score">0/7 days completed</span>
              </div>
              <div class="streak-rail-track">
                <div class="streak-rail-fill" id="week-score-fill"></div>
              </div>
            </div>
            <div class="heatmap-message" id="heatmap-message" style="display: none;"></div>
          </div>
        </div>
      </section>

      <section class="card settings ios-tap ios-card">
        <h2>Goals</h2>
        <div class="segmented">
          <button class="seg-btn ios-tap ios-button" data-goal="low">Low</button>
          <button class="seg-btn ios-tap ios-button active" data-goal="default">Default</button>
          <button class="seg-btn ios-tap ios-button" data-goal="high">High</button>
        </div>
        <div class="goal-grid">
          <div class="goal-item">
            <label>GitHub commits/day</label>
            <input type="number" min="0" id="goal-github" />
          </div>
          <div class="goal-item">
            <label>LeetCode solved/day</label>
            <input type="number" min="0" id="goal-leetcode" />
          </div>
        </div>
        <button class="primary ios-tap ios-button" id="save-goals">Save goals</button>
      </section>

      <section class="card settings ios-tap ios-card">
        <h2>Reminders</h2>
        <div class="reminders">
          <input type="time" id="reminder-1" />
          <input type="time" id="reminder-2" />
        </div>
        <button class="primary ios-tap ios-button" id="save-reminders">Save reminders</button>
      </section>

      <section class="card settings ios-tap ios-card">
        <h2>Repos filter</h2>
        <p class="hint">Comma-separated owner/repo. Leave empty to count all repos.</p>
        <textarea id="repos" rows="2" placeholder="owner/repo, owner2/repo2"></textarea>
        <button class="primary ios-tap ios-button" id="save-repos">Save repos</button>
      </section>

      <section class="quick-actions">
        <button class="ghost ios-tap ios-button" id="open-settings">Open bot settings</button>
        <button class="ghost ios-tap ios-button" id="open-status">Check bot status</button>
      </section>
    </div>

    <div class="loading-overlay" id="loading-overlay" aria-hidden="true">
      <div class="spinner" role="status" aria-label="Loading"></div>
    </div>

    <div class="ios-sheet-backdrop" id="avatar-backdrop" aria-hidden="true"></div>
    <div class="ios-sheet" id="avatar-sheet" role="dialog" aria-modal="true" aria-label="Choose avatar">
      <div class="sheet-handle"></div>
      <h3>Choose avatar</h3>
      <div class="avatar-grid" id="avatar-grid"></div>
    </div>

    <div class="insight-backdrop" id="insight-backdrop" aria-hidden="true"></div>
    <div class="insight-card" id="insight-card" role="dialog" aria-modal="true" aria-label="Daily insight">
      <div class="insight-handle"></div>
      <div class="insight-header">
        <h3 id="insight-title">Day</h3>
        <button class="icon-btn ios-tap ios-button" id="insight-close" type="button" aria-label="Close">
          ‚úï
        </button>
      </div>
      <div class="insight-body">
        <div class="insight-row">
          <span>GitHub</span>
          <span id="insight-github">0 / 0</span>
          <span id="insight-github-remaining" class="insight-remaining">0 left</span>
        </div>
        <div class="insight-row">
          <span>LeetCode</span>
          <span id="insight-leetcode">0 / 0</span>
          <span id="insight-leetcode-remaining" class="insight-remaining">0 left</span>
        </div>
        <div class="insight-suggestion" id="insight-suggestion">‚Äî</div>
      </div>
    </div>

    <script>
      window.__BOT_USERNAME__ = "{{ bot_username }}";
    </script>
    <script src="/static/app.js"></script>
  </body>
</html>
